Taken from https://github.com/knuckleslee/RhythmCodes/tree/master/2J3B3LED_gcjoy/leo under the GPL3 license.
Modified it for my use.

1.put boards.txt in C:\Program Files (x86)\Arduino\hardware\arduino\avr, backup the old one  
2.install this library https://github.com/celclow/SwitchControlLibrary/releases/tag/v1.0.0 (make sure it's v1.0.0)  
3.select board type: Leonardo Pokken  
4.upload code  